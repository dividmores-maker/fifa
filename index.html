<!doctype html>
<html lang="ar" dir="rtl">

<head>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js"></script>
    <script>
        // Ø§Ø³ØªØ¨Ø¯Ù„ Ø¨Ø§Ù„Ù‚ÙŠÙ… Ø¨ØªØ§Ø¹ØªÙƒ
        const SUPABASE_URL = "https://YOUR_PROJECT.supabase.coeyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh1bnJnZ21yaHBoZGhwcnV6emN0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3MDE4MDYsImV4cCI6MjA3ODI3NzgwNn0.bHhm-zGy5JkWzLp8QSzFUqfMdjVXap7-oFrQNsjX4qw";
        const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh1bnJnZ21yaHBoZGhwcnV6emN0Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2MjcwMTgwNiwiZXhwIjoyMDc4Mjc3ODA2fQ.ZsnbhL57dne1Tyf3LT2Keu-rz64T3hQuLkJAZrnhMTU";

        const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        // Ù…Ø«Ø§Ù„: Ø¬Ù„Ø¨ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„
        async function fetchData() {
            const { data, error } = await supabase
                .from('shared_data')
                .select('*');
            console.log(data);
        }

        // Ù…Ø«Ø§Ù„: Ø¥Ø¶Ø§ÙØ© Ø³Ø¬Ù„ Ø¬Ø¯ÙŠØ¯
        async function addData(name, score) {
            const { data, error } = await supabase
                .from('shared_data')
                .insert([{ name, score }]);
            if (error) console.log(error);
            else console.log("ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©:", data);
        }

        fetchData();
    </script>

    <style>
        body::before {
            content: "";
            position: fixed;
            top: 50%;
            left: 50%;
            width: 800px;
            height: 800px;
            background: url('logo.png') no-repeat center center;
            background-size: contain;
            opacity: 0.12;
            transform: translate(-50%, -50%);
            pointer-events: none;
            z-index: 0;
        }
    </style>

</head>

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ù„Ø¬Ù†Ù‡ Ø§Ù„Ø§Ù†Ø´Ø·Ù‡ Ùˆ Ø§Ù„Ù…Ø³Ø¨Ù‚Ø§Øª - Ù†Ø¸Ø§Ù… Ø¯ÙˆØ±ÙŠ ÙˆÙ…Ø³Ø§Ø¨Ù‚Ø©</title>
<style>
    :root {
        --bg-1: #1b0f2b;
        /* dark purple */
        --bg-2: #2f2350;
        /* mid purple */
        --accent: #7b61ff;
        --muted: #bfc8eb;
        --card: rgba(255, 255, 255, 0.03);
        --green: #d4f8d4;
        --red: #f8d4d4;
        --glass: rgba(255, 255, 255, 0.04);
    }

    html,
    body {
        height: 100%;
        margin: 0;
        font-family: Tahoma, Arial, sans-serif;
        background: linear-gradient(180deg, var(--bg-1), var(--bg-2));
        color: #eef2ff;
        direction: rtl
    }

    /* ---------- login overlay styles ---------- */
    .login-wrap {
        position: fixed;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999
    }

    .login-card {
        width: 100%;
        max-width: 760px;
        background: linear-gradient(180deg, rgba(255, 255, 255, 0.03), rgba(255, 255, 255, 0.02));
        border-radius: 14px;
        padding: 28px;
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(6px);
        border: 1px solid rgba(255, 255, 255, 0.03)
    }

    .login-head {
        display: flex;
        gap: 14px;
        align-items: center
    }

    .login-logo {
        width: 64px;
        height: 64px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(180deg, #4e2ea6, #2a0f44);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.6);
        font-size: 28px
    }

    .login-title {
        font-size: 20px;
        font-weight: 800;
        color: var(--muted)
    }

    .login-sub {
        color: var(--muted);
        font-size: 13px;
        margin-top: 4px
    }

    .login-body {
        display: flex;
        gap: 20px;
        margin-top: 18px;
        flex-wrap: wrap
    }

    .login-column {
        flex: 1;
        min-width: 220px
    }

    .role-btn {
        width: 100%;
        padding: 12px;
        border-radius: 10px;
        border: none;
        cursor: pointer;
        font-size: 16px
    }

    .role-view {
        background: linear-gradient(90deg, #7b61ff, #6f54d6);
        color: white
    }

    .role-admin {
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.08);
        color: var(--muted)
    }

    .pass-row {
        display: flex;
        gap: 8px;
        margin-top: 6px
    }

    .pass-input {
        flex: 1;
        padding: 10px;
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.06);
        background: transparent;
        color: #eef2ff
    }

    .pass-submit {
        padding: 10px 12px;
        border-radius: 8px;
        border: none;
        cursor: pointer;
        background: linear-gradient(90deg, #2ea8ff, #7b61ff);
        color: white
    }

    /* small helper for hidden content */
    .hidden {
        display: none !important
    }

    /* ---------- original app styles (kept) ---------- */
    /* top nav */
    .topnav {
        display: flex;
        align-items: center;
        gap: 12px;
        justify-content: space-between;
        padding: 10px 18px;
        background: linear-gradient(90deg, rgba(0, 0, 0, 0.25), rgba(255, 255, 255, 0.02));
        position: sticky;
        top: 0;
        z-index: 50;
        backdrop-filter: blur(6px)
    }

    .brand {
        display: flex;
        align-items: center;
        gap: 10px
    }

    .logo {
        width: 42px;
        height: 42px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(180deg, #4e2ea6, #2a0f44);
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.5);
    }

    .logo span {
        font-size: 20px
    }

    .sitename {
        font-weight: 700;
        font-size: 16px;
        color: var(--muted)
    }

    .navtabs {
        display: flex;
        gap: 10px;
        align-items: center
    }

    .tabbtn {
        padding: 8px 12px;
        border-radius: 8px;
        border: 1px solid transparent;
        cursor: pointer;
        background: transparent;
        color: var(--muted)
    }

    .tabbtn.active {
        background: linear-gradient(90deg, var(--accent), #2ea8ff);
        color: #fff;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.35)
    }

    .actions {
        display: flex;
        gap: 8px;
        align-items: center
    }

    /* container & cards */
    .wrap {
        max-width: 1150px;
        margin: 18px auto;
        padding: 12px
    }

    .card {
        background: var(--card);
        border-radius: 12px;
        padding: 14px;
        margin-bottom: 14px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.45)
    }

    label {
        font-weight: 700;
        color: var(--muted)
    }

    input,
    select,
    textarea,
    button {
        font-size: 14px;
        border-radius: 8px;
        padding: 8px;
        border: 1px solid rgba(255, 255, 255, 0.06);
        background: transparent;
        color: #eef2ff
    }

    textarea {
        resize: vertical
    }

    .row {
        display: flex;
        gap: 12px;
        flex-wrap: wrap
    }

    .col {
        flex: 1;
        min-width: 180px
    }

    .muted {
        color: var(--muted);
        font-size: 13px
    }

    .primary {
        background: linear-gradient(90deg, #7b61ff, #2ea8ff);
        border: none;
        color: #fff;
        padding: 8px 12px;
        border-radius: 8px;
        cursor: pointer
    }

    .ghost {
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.06);
        color: var(--muted);
        padding: 8px 10px;
        border-radius: 8px;
        cursor: pointer
    }

    /* groups list */
    .groups-list {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        margin-top: 12px
    }

    .group-card {
        min-width: 150px;
        padding: 12px;
        border-radius: 10px;
        background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), transparent);
        cursor: pointer;
        border: 1px solid rgba(255, 255, 255, 0.04);
        text-align: center
    }

    .group-card strong {
        display: block;
        font-size: 16px;
        color: #fff
    }

    /* tabs content */
    .tabs {
        margin-top: 12px
    }

    .tabcontent {
        display: none;
        animation: fadeIn 300ms ease both
    }

    .tabcontent.active {
        display: block
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(6px)
        }

        to {
            opacity: 1;
            transform: none
        }
    }

    /* group view matches */
    .matches-list {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-top: 12px
    }

    .match {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        border-radius: 8px;
        background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), transparent);
        border: 1px solid rgba(255, 255, 255, 0.03)
    }

    .match .teams {
        font-weight: 700
    }

    .small {
        font-size: 13px;
        color: var(--muted)
    }

    /* bracket (horizontal classic) */
    .bracket {
        display: flex;
        gap: 18px;
        align-items: flex-start;
        overflow: auto;
        padding: 10px;
        margin-top: 12px
    }

    .bracket-col {
        display: flex;
        flex-direction: column;
        gap: 12px;
        align-items: center
    }

    .slot {
        min-width: 220px;
        background: rgba(0, 0, 0, 0.12);
        padding: 10px;
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.03);
        text-align: center
    }

    .slot .team {
        padding: 6px;
        border-radius: 6px;
        background: linear-gradient(90deg, rgba(255, 255, 255, 0.02), transparent);
        margin: 6px 0
    }

    .slot .controls {
        display: flex;
        gap: 6px;
        justify-content: center;
        margin-top: 8px
    }

    .slot button {
        padding: 6px 8px;
        border-radius: 6px;
        border: none;
        cursor: pointer
    }

    /* dashboard tables */
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 8px
    }

    th,
    td {
        padding: 8px;
        border: 1px solid rgba(255, 255, 255, 0.04);
        text-align: center
    }

    th {
        background: rgba(255, 255, 255, 0.02);
        font-weight: 700
    }

    .winner {
        background: var(--green);
        color: #07320a
    }

    .loser {
        background: var(--red);
        color: #581111
    }

    @media (max-width:900px) {
        .bracket {
            gap: 8px
        }

        .slot {
            min-width: 140px
        }
    }

    @media (max-width:600px) {
        .row {
            flex-direction: column
        }

        .topnav {
            flex-direction: column;
            gap: 8px;
            align-items: flex-start
        }

        .navtabs {
            width: 100%;
            display: flex;
            overflow: auto
        }
    }

    .center {
        text-align: center
    }

    .inline {
        display: inline-block
    }

    .space {
        height: 10px
    }

    .saved-note {
        font-size: 13px;
        color: #b9d1ff;
        margin-top: 8px
    }
</style>
</head>

<body>

    <!-- LOGIN WRAPPER -->
    <div id="loginWrap" class="login-wrap">
        <div class="login-card" role="dialog" aria-labelledby="loginTitle">
            <div class="login-head">
                <img src="logo.png" alt="Ù„Ø¬Ù†Ø© Ø§Ù„Ø£Ù†Ø´Ø·Ø© ÙˆØ§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª" class="login-logo"
                    style="width:64px;height:64px;border-radius:12px;">

                <div>
                    <div id="loginTitle" class="login-title">Ø¯Ø®ÙˆÙ„ Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ùˆ Ø¹Ø±Ø¶ â€” Ù„Ø¬Ù†Ù‡ Ø§Ù„Ø§Ù†Ø´Ø·Ù‡ Ùˆ Ø§Ù„Ù…Ø³Ø¨Ù‚Ø§Øª</div>
                    <div class="login-sub">Ø§Ø®ØªØ± Ø¯ÙˆØ±Ùƒ. Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯ ÙŠØ±Ù‰ Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ ÙÙ‚Ø·. Ù„Ø¬Ù†Ø© Ø§Ù„ØªÙ†Ø¸ÙŠÙ… ØªØ­ØªØ§Ø¬ ÙƒÙ„Ù…Ø© Ø³Ø± Ù„Ù„ÙˆØµÙˆÙ„
                        Ø§Ù„ÙƒØ§Ù…Ù„.</div>
                </div>
            </div>

            <div class="login-body">
                <div class="login-column">
                    <label style="font-weight:700;margin-bottom:8px;display:block">Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø´Ø§Ù‡Ø¯</label>
                    <button id="btnViewer" class="role-btn role-view">Ù…Ø´Ø§Ù‡Ø¯ â€” Ø¹Ø±Ø¶ Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ ÙÙ‚Ø·</button>
                    <div style="margin-top:10px;color:var(--muted);font-size:13px">Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯ Ù„Ù† ÙŠØ³ØªØ·ÙŠØ¹ ØªØ¹Ø¯ÙŠÙ„ Ø£Ùˆ Ø§Ù„ÙˆØµÙˆÙ„
                        Ù„Ø£Ø¯ÙˆØ§Øª
                        Ø§Ù„ØªØ­ÙƒÙ….</div>
                </div>

                <div class="login-column">
                    <label style="font-weight:700;margin-bottom:8px;display:block">Ø¯Ø®ÙˆÙ„ ÙƒÙ„Ø¬Ù†Ø© Ø§Ù„ØªÙ†Ø¸ÙŠÙ…</label>
                    <button id="btnAdminShow" class="role-btn role-admin">Ù„Ø¬Ù†Ø© Ø§Ù„ØªÙ†Ø¸ÙŠÙ… â€” Ø£Ø·Ù„Ø¨ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±</button>
                    <div class="pass-row" id="passRow" style="display:none;">
                        <input id="adminPass" class="pass-input" type="password" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                        <button id="btnAdmin" class="pass-submit">Ø¯Ø®ÙˆÙ„</button>
                    </div>
                    <div style="margin-top:10px;color:var(--muted);font-size:13px">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
                        <strong>P@ssw0rd</strong>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MAIN APP (Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£ØµÙ„ÙŠ) -->
    <div id="appContainer" class="hidden">
        <!-- ==== START: Original app content (topnav, wrap, all UI) ==== -->
        <!-- I'm embedding your original app UI & JS here (kept intact). -->
        <!-- Top nav + app content -->
        <div class="topnav">
            <div class="brand">
                <img src="logo.png" alt="Ù„Ø¬Ù†Ø© Ø§Ù„Ø£Ù†Ø´Ø·Ø© ÙˆØ§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª" class="main-logo"
                    style="width:42px;height:42px;border-radius:10px;">

                <div>
                    <div class="sitename">Ù„Ø¬Ù†Ù‡ Ø§Ù„Ø§Ù†Ø´Ø·Ù‡ Ùˆ Ø§Ù„Ù…Ø³Ø¨Ù‚Ø§Øª</div>
                    <div class="small muted" style="font-size:12px">Ù†Ø¸Ø§Ù… Ø¯ÙˆØ±ÙŠ + ÙƒØ£Ø³ â€” Ù…ØªØ¬Ø§ÙˆØ¨ ÙˆØ°ÙƒÙŠ</div>
                </div>
            </div>

            <div class="navtabs" role="tablist" aria-label="Ø§Ù„ØµÙØ­Ø§Øª">
                <button class="tabbtn active" data-tab="tab-groups">ğŸ ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</button>
                <button class="tabbtn" data-tab="tab-bracket">ğŸŒ³ Ø´Ø¬Ø±Ø© Ø§Ù„ÙƒØ£Ø³</button>
                <button class="tabbtn" data-tab="tab-dashboard">ğŸ“Š Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</button>
            </div>

            <div class="actions">
                <button id="saveBtn" class="ghost">ğŸ’¾ Ø­ÙØ¸</button>
                <button id="loadBtn" class="ghost">ğŸ“‚ Ø§Ø³ØªØ±Ø¬Ø§Ø¹</button>
            </div>
        </div>

        <div class="wrap">
            <!-- Groups Tab -->
            <div id="tab-groups" class="tabcontent active">
                <div class="card">
                    <div class="row">
                        <div class="col">
                            <label>Ø¹Ø¯Ø¯ Ø§Ù„ÙØ±Ù‚ (ÙƒÙ„ÙŠ)</label>
                            <input id="inputTotal" type="number" min="2" value="16" />
                            <div class="small muted">Ù…Ø«Ø§Ù„: 8, 12, 16, 20</div>
                        </div>
                        <div class="col">
                            <label>ÙØ±Ù‚ Ø¨ÙƒÙ„ Ù…Ø¬Ù…ÙˆØ¹Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                            <input id="inputPerGroup" type="number" min="2" placeholder="Ø§ØªØ±ÙƒÙ‡ Ù„ÙŠÙØ­Ø³Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹" />
                            <div class="small muted">Ù„Ùˆ ÙØ§Ø¶ÙŠ Ø³ÙŠÙ‚Ø³Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø´ÙƒÙ„ Ù…ØªÙ‚Ø§Ø±Ø¨</div>
                        </div>
                        <div class="col" style="display:flex;align-items:flex-end;gap:8px">
                            <button id="btnCreate" class="primary">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</button>
                            <button id="btnDemo" class="ghost">Ù…Ù„Ø£ ØªØ¬Ø±ÙŠØ¨ÙŠ</button>
                        </div>
                    </div>
                </div>

                <div id="teamsInputCard" class="card" style="display:none">
                    <label>Ø£Ø¯Ø®Ù„ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ÙØ±Ù‚ (Ø³Ø·Ø± Ù„ÙƒÙ„ ÙØ±ÙŠÙ‚)</label>
                    <textarea id="teamsText" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø§Ù‡Ù„ÙŠ"></textarea>
                    <div style="text-align:left;margin-top:8px">
                        <button id="btnAutoAssign" class="primary">ØªÙˆØ²ÙŠØ¹ ØªÙ„Ù‚Ø§Ø¦ÙŠ</button>
                        <button id="btnManualAssign" class="ghost">ØªÙˆØ²ÙŠØ¹ ÙŠØ¯ÙˆÙŠ</button>
                        <span class="saved-note" id="assignNote"></span>
                    </div>
                </div>

                <div id="groupsOverview" class="card" style="display:none">
                    <label>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</label>
                    <div class="groups-list" id="groupsList"></div>
                    <div class="small muted">Ø§Ø¶ØºØ· Ø§Ø³Ù… Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ù„Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„Ù‡Ø§ Ø£Ø³ÙÙ„Ø§Ù‹.</div>
                </div>

                <div id="groupDetails" class="card" style="display:none">
                    <div class="row">
                        <div class="col">
                            <h3 id="groupTitle">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© A</h3>
                            <div class="small muted" id="groupTeamsLine"></div>
                            <div class="matches-list" id="groupMatches"></div>
                        </div>
                        <div class="col">
                            <h3>ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©</h3>
                            <table id="groupTable">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>ÙØ±ÙŠÙ‚</th>
                                        <th>Ù„Ø¹Ø¨</th>
                                        <th>Ù</th>
                                        <th>Øª</th>
                                        <th>Ø®</th>
                                        <th>Ù„Ù‡</th>
                                        <th>Ø¹Ù„ÙŠÙ‡</th>
                                        <th>ÙØ±Ù‚</th>
                                        <th>Ù†Ù‚Ø§Ø·</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                            <div style="margin-top:8px"><button id="btnToBracketFromGroup" class="primary">Ø¥Ø¶Ø§ÙØ© Ù…ØªØ£Ù‡Ù„ÙŠÙ†
                                    Ù„Ù„Ø´Ø¬Ø±Ø©
                                    Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</button></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bracket Tab -->
            <div id="tab-bracket" class="tabcontent">
                <div class="card">
                    <h3 class="center">Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© â€” Ù†Ø¸Ø§Ù… Ø®Ø±ÙˆØ¬ Ù…Ø¨Ø§Ø´Ø± (ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ)</h3>
                    <div style="display:flex;gap:8px;justify-content:center">
                        <label style="align-self:center">Ø§Ù„Ù…ØªØ£Ù‡Ù„ÙŠÙ† Ù…Ù† ÙƒÙ„ Ù…Ø¬Ù…ÙˆØ¹Ø© :</label>
                        <select id="qualifyCount">
                            <option value="1">1</option>
                            <option value="2">2</option>
                        </select>
                        <button id="btnBuildBracket" class="primary">Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø´Ø¬Ø±Ø©</button>
                    </div>

                    <div id="bracketArea" class="bracket" style="margin-top:12px"></div>
                </div>
            </div>

            <!-- Dashboard Tab -->
            <div id="tab-dashboard" class="tabcontent">
                <div class="card">
                    <h3 class="center">Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ â€” Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…ÙØµÙ„Ø©</h3>
                    <div style="display:flex;gap:12px;flex-wrap:wrap">
                        <div style="flex:1;min-width:300px">
                            <h4 class="center">Ø§Ù„ÙØ±Ù‚ Ø§Ù„ÙƒØ³Ø¨Ø§Ù†Ø©</h4>
                            <table id="winnersTable">
                                <thead>
                                    <tr>
                                        <th>Ø§Ù„ÙØ±ÙŠÙ‚</th>
                                        <th>ÙÙˆØ²</th>
                                        <th>Ù†Ù‚Ø§Ø·</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                        <div style="flex:1;min-width:300px">
                            <h4 class="center">Ø§Ù„ÙØ±Ù‚ Ø§Ù„Ø®Ø³Ø±Ø§Ù†Ø©</h4>
                            <table id="losersTable">
                                <thead>
                                    <tr>
                                        <th>Ø§Ù„ÙØ±ÙŠÙ‚</th>
                                        <th>Ø®Ø³Ø§Ø±Ø©</th>
                                        <th>Ù†Ù‚Ø§Ø·</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>

                    <hr style="margin:12px 0;border-color:rgba(255,255,255,0.04)">
                    <h4>ØªÙØµÙŠÙ„ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</h4>
                    <div id="groupsTables" style="display:flex;gap:12px;flex-wrap:wrap;margin-top:8px"></div>
                </div>
            </div>

        </div>
        <!-- ==== END: Original app content ==== -->
    </div>

    <script>
        /* ================== Login / Role control ================== */
        const PASSWORD = '123'; // ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù€ Ù„Ø¬Ù†Ø© Ø§Ù„ØªÙ†Ø¸ÙŠÙ…

        const loginWrap = document.getElementById('loginWrap');
        const appContainer = document.getElementById('appContainer');

        const btnViewer = document.getElementById('btnViewer');
        const btnAdminShow = document.getElementById('btnAdminShow');
        const passRow = document.getElementById('passRow');
        const adminPass = document.getElementById('adminPass');
        const btnAdmin = document.getElementById('btnAdmin');

        let CURRENT_ROLE = null; // "viewer" or "admin"

        btnViewer.addEventListener('click', () => {
            CURRENT_ROLE = 'viewer';
            enterAsViewer();
        });

        btnAdminShow.addEventListener('click', () => {
            passRow.style.display = passRow.style.display === 'flex' || passRow.style.display === 'block' ? 'none' : 'flex';
            if (passRow.style.display === 'flex') adminPass.focus();
        });

        btnAdmin.addEventListener('click', () => {
            const v = adminPass.value || '';
            if (v === PASSWORD) {
                CURRENT_ROLE = 'admin';
                enterAsAdmin();
            } else {
                alert('ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø®Ø§Ø·Ø¦Ø©.');
                adminPass.value = '';
                adminPass.focus();
            }
        });

        // When pressing Enter inside password field
        adminPass.addEventListener('keyup', (e) => {
            if (e.key === 'Enter') btnAdmin.click();
        });

        function enterAsViewer() {
            // hide login, show app
            loginWrap.classList.add('hidden');
            appContainer.classList.remove('hidden');
            applyViewerMode();
            // switch to dashboard tab
            const dashBtn = document.querySelector('[data-tab="tab-dashboard"]');
            if (dashBtn) dashBtn.click();
        }

        function enterAsAdmin() {
            loginWrap.classList.add('hidden');
            appContainer.classList.remove('hidden');
            applyAdminMode();
            // open groups tab (admin)
            const groupsBtn = document.querySelector('[data-tab="tab-groups"]');
            if (groupsBtn) groupsBtn.click();
        }

        /* ---------- functions to adjust UI per role ---------- */

        function applyViewerMode() {
            // hide group and bracket tabs from nav
            document.querySelectorAll('.navtabs .tabbtn').forEach(btn => {
                if (btn.dataset.tab !== 'tab-dashboard') btn.style.display = 'none';
                else btn.style.display = 'inline-flex';
            });
            // hide actions except maybe save? for viewer hide save/load
            document.querySelectorAll('.actions button').forEach(b => b.style.display = 'none');

            // Hide interactive controls in dashboard and bracket and groups
            // Disable buttons (just hide control buttons)
            document.querySelectorAll('button.primary, button.ghost').forEach(b => {
                // allow only nothing - but we still keep them visible inside dashboard tables (they're not used there)
                b.dataset._origDisplay = b.style.display || '';
                b.style.pointerEvents = 'none'; // disable clicks
                b.style.opacity = '0.6';
            });

            // Enable interactions that are necessary for dashboard viewing (none needed)
            // Ensure only dashboard tab is active
            document.querySelectorAll('.tabcontent').forEach(tc => tc.classList.remove('active'));
            const tb = document.getElementById('tab-dashboard');
            if (tb) tb.classList.add('active');
            // render dashboard to ensure shown
            if (typeof renderDashboard === 'function') renderDashboard();
        }

        function applyAdminMode() {
            // show all navtabs
            document.querySelectorAll('.navtabs .tabbtn').forEach(btn => btn.style.display = 'inline-flex');
            // show actions
            document.querySelectorAll('.actions button').forEach(b => b.style.display = 'inline-flex');
            // re-enable buttons
            document.querySelectorAll('button.primary, button.ghost').forEach(b => {
                b.style.pointerEvents = '';
                b.style.opacity = '';
            });
            // initial render
            if (typeof renderGroupsOverview === 'function') renderGroupsOverview();
            if (typeof renderDashboard === 'function') renderDashboard();
        }

        /* If user closed login and used back: keep role */
        window.addEventListener('load', () => {
            // nothing â€” app will be initialised by original app code below.
        });

        /* =============== End of login logic =============== */

        /* =============== Original app JS (kept intact) =============== */
        /* Below I embed the app code that you provided (kept but slightly adapted so it works inside this file).
           All original functions are preserved. If you want further fixes (e.g. UI changes), Ø£Ø®Ø¨Ø±Ù†ÙŠ. */

        const STORAGE_KEY = 'tournament.state.v1';
        let STATE = { teams: [], groups: [], groupMatches: [], knockout: null };

        // ÙÙŠ Ø£ÙˆÙ„ Ø§Ù„Ù…Ù„Ù - ØªØ­Ù…ÙŠÙ„ Firebase SDK
        <script src="https://www.gstatic.com/firebasejs/12.5.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore-compat.js"></script>

    // Ù…ØªØºÙŠØ±Ø§Øª Firebase
    let db = null;
    let isFirebaseReady = false;

    // ØªÙ‡ÙŠØ¦Ø© Firebase (Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©)
    function initFirebase() {
    const config = {
    apiKey: "AIzaSyDyPj6YoZTGg5qhvxXLDu2EqK9wMU3_GTg",
    authDomain: "anshta-f64db.firebaseapp.com",
    projectId: "anshta-f64db",
    storageBucket: "anshta-f64db.firebasestorage.app",
    messagingSenderId: "602935137290",
    appId: "1:602935137290:web:76c7fce4755b943ca3fbf3"
    };

    if (!firebase.apps.length) {
    firebase.initializeApp(config);
    }
    db = firebase.firestore();
    isFirebaseReady = true;
    }

    // Ø§Ø³ØªØ¨Ø¯Ù„ Ø¯Ø§Ù„Ø© saveState Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¨Ø¯ÙŠ:
    async function saveState() {
    if (!isFirebaseReady) {
    // Ù„Ùˆ Firebase Ù…Ø´ Ø¬Ø§Ù‡Ø²ØŒ Ø§Ø­ÙØ¸ Ù…Ø­Ù„ÙŠ Ø¨Ø³
    localStorage.setItem(STORAGE_KEY, JSON.stringify(STATE));
    return;
    }

    try {
    STATE.lastUpdate = new Date().toISOString();
    await db.collection('appData').doc('mainState').set({
    state: STATE,
    timestamp: firebase.firestore.FieldValue.serverTimestamp()
    });

    const sb = document.getElementById('saveBtn');
    if (sb) {
    sb.textContent = 'âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸ Ù„Ù„Ø³Ø­Ø§Ø¨Ø©';
    setTimeout(() => sb.textContent = 'ğŸ’¾ Ø­ÙØ¸', 1200);
    }
    } catch (error) {
    console.error('Firebase save error:', error);
    // Ù„Ùˆ ÙÙŠ Ù…Ø´ÙƒÙ„Ø©ØŒ Ø§Ø­ÙØ¸ Ù…Ø­Ù„ÙŠ
    localStorage.setItem(STORAGE_KEY, JSON.stringify(STATE));
    }
    }

    // Ø§Ø³ØªØ¨Ø¯Ù„ Ø¯Ø§Ù„Ø© loadState Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¨Ø¯ÙŠ:
    async function loadState() {
    if (!isFirebaseReady) {
    // Ù„Ùˆ Firebase Ù…Ø´ Ø¬Ø§Ù‡Ø²ØŒ Ø­Ù…Ù„ Ù…Ù† Ø§Ù„Ù…Ø­Ù„ÙŠ
    const s = localStorage.getItem(STORAGE_KEY);
    if (!s) return false;
    STATE = JSON.parse(s);
    renderAfterLoad();
    return true;
    }

    try {
    const doc = await db.collection('appData').doc('mainState').get();
    if (doc.exists) {
    STATE = doc.data().state;
    renderAfterLoad();

    const lb = document.getElementById('loadBtn');
    if (lb) {
    lb.textContent = 'âœ… ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©';
    setTimeout(() => lb.textContent = 'ğŸ“‚ Ø§Ø³ØªØ±Ø¬Ø§Ø¹', 1200);
    }
    return true;
    }
    } catch (error) {
    console.error('Firebase load error:', error);
    // Ù„Ùˆ ÙÙŠ Ù…Ø´ÙƒÙ„Ø©ØŒ Ø­Ù…Ù„ Ù…Ù† Ø§Ù„Ù…Ø­Ù„ÙŠ
    const s = localStorage.getItem(STORAGE_KEY);
    if (!s) return false;
    STATE = JSON.parse(s);
    renderAfterLoad();
    }
    return false;
    }

    function computeGroups(numTeams, perOpt) {
    if (perOpt && perOpt >= 2) return Math.max(1, Math.ceil(numTeams / perOpt));
    let g = Math.round(Math.sqrt(numTeams));
    if (g < 2) g=2; while (Math.ceil(numTeams / g) < 2) g--; while (g> numTeams) g = numTeams;
        return g;
        }

        /* ---------- UI Tab switching ---------- */
        document.querySelectorAll('.tabbtn').forEach(btn => {
        btn.addEventListener('click', () => {
        document.querySelectorAll('.tabbtn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const tab = btn.dataset.tab;
        document.querySelectorAll('.tabcontent').forEach(tc => tc.classList.remove('active'));
        const el = document.getElementById(tab);
        if (el) el.classList.add('active');
        if (tab === 'tab-bracket') renderBracketArea();
        if (tab === 'tab-dashboard') renderDashboard();
        });
        });

        /* ---------- create groups flow ---------- */
        const btnCreate = document.getElementById('btnCreate');
        if (btnCreate) btnCreate.onclick = () => {
        const total = Math.max(2, parseInt(document.getElementById('inputTotal').value || 0));
        const per = parseInt(document.getElementById('inputPerGroup').value || 0) || null;
        const groupsCount = computeGroups(total, per);
        STATE = { teams: [], groups: Array.from({ length: groupsCount }, () => []), groupMatches: [], knockout: null };
        saveState();
        document.getElementById('teamsInputCard').style.display = 'block';
        document.getElementById('groupsOverview').style.display = 'none';
        document.getElementById('groupDetails').style.display = 'none';
        const an = document.getElementById('assignNote');
        if (an) an.textContent = `ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ${groupsCount} Ù…Ø¬Ù…ÙˆØ¹Ø§Øª â€” Ø§Ù„Ø¢Ù† Ø£Ø¯Ø®Ù„ ${total} Ø£Ø³Ù…Ø§Ø¡.`;
        scrollToElement('teamsInputCard');
        }

        const btnDemo = document.getElementById('btnDemo');
        if (btnDemo) btnDemo.onclick = () => {
        document.getElementById('inputTotal').value = 16;
        document.getElementById('teamsText').value =
        `Ø§Ù„Ø£Ù‡Ù„ÙŠ\nØ§Ù„Ø²Ù…Ø§Ù„Ùƒ\nØ¨ÙŠØ±Ø§Ù…ÙŠØ¯Ø²\nØ³Ù…ÙˆØ­Ø©\nØ§Ù„Ù…ØµØ±ÙŠ\nØ§Ù†Ø¨ÙŠ\nØ§Ù„Ù…Ù‚Ø§ÙˆÙ„ÙˆÙ†\nØ§Ù„Ø§ØªØ­Ø§Ø¯\nØ§Ù„Ø§ØªØ­Ø§Ø¯ Ø§Ù„Ø³ÙƒÙ†Ø¯Ø±ÙŠ\nØ§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠ\nØ·Ù„Ø§Ø¦Ø¹
        Ø§Ù„Ø¬ÙŠØ´\nÙ…ØµØ±
        Ø§Ù„Ù…Ù‚Ø§ØµØ©\nØ­Ø±Ø³ Ø§Ù„Ø­Ø¯ÙˆØ¯\nÙØ±ÙŠÙ‚ Ø£\nÙØ±ÙŠÙ‚ Ø¨\nÙØ±ÙŠÙ‚ Ø¬`;
        document.getElementById('teamsInputCard').style.display = 'block';
        const an = document.getElementById('assignNote');
        if (an) an.textContent = 'Ù…Ù„Ø£ ØªØ¬Ø±ÙŠØ¨ÙŠ â€” Ø§Ø¶ØºØ· ØªÙˆØ²ÙŠØ¹ ØªÙ„Ù‚Ø§Ø¦ÙŠ';
        }

        /* assign teams automatically */
        const btnAutoAssign = document.getElementById('btnAutoAssign');
        if (btnAutoAssign) btnAutoAssign.onclick = () => {
        const txt = document.getElementById('teamsText').value.trim();
        if (!txt) return alert('Ø£Ø¯Ø®Ù„ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ÙØ±Ù‚.');
        const names = txt.split('\n').map(s => s.trim()).filter(Boolean);
        const totalDeclared = parseInt(document.getElementById('inputTotal').value) || names.length;
        if (names.length !== totalDeclared) {
        if (!confirm(`Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø·Ø± (${names.length}) Ù„Ø§ ÙŠØ³Ø§ÙˆÙŠ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¯Ø®Ù„ (${totalDeclared}). Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± Ù…Ø¹
        ${names.length}ØŸ`)) return;
        }
        const groupsCount = STATE.groups.length;
        STATE.teams = names.map(n => ({ name: n, group: null, played: 0, win: 0, draw: 0, loss: 0, gf: 0, ga: 0, pts: 0
        }));
        let idx = 0;
        STATE.groups = Array.from({ length: groupsCount }, () => []);
        STATE.teams.forEach(t => {
        const g = idx % groupsCount;
        STATE.groups[g].push(t.name);
        t.group = g;
        idx++;
        });
        scheduleAllGroupMatches();
        saveState();
        renderGroupsOverview();
        document.getElementById('teamsInputCard').style.display = 'none';
        document.getElementById('groupsOverview').style.display = 'block';
        document.getElementById('groupDetails').style.display = 'none';
        scrollToElement('groupsOverview');
        }

        /* manual assign opens a simple UI (inline) */
        const btnManualAssign = document.getElementById('btnManualAssign');
        if (btnManualAssign) btnManualAssign.onclick = () => {
        const txt = document.getElementById('teamsText').value.trim();
        if (!txt) return alert('Ø£Ø¯Ø®Ù„ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ÙØ±Ù‚.');
        const names = txt.split('\n').map(s => s.trim()).filter(Boolean);
        STATE.teams = names.map(n => ({ name: n, group: null, played: 0, win: 0, draw: 0, loss: 0, gf: 0, ga: 0, pts: 0
        }));
        STATE.groups = Array.from({ length: STATE.groups.length }, () => []);
        saveState();
        let remaining = [...STATE.teams.map(t => t.name)];
        for (const name of [...remaining]) {
        let g = prompt(`Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© (1..${STATE.groups.length}) Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙØ±ÙŠÙ‚ "${name}" Ø£Ùˆ Ø§ØªØ±Ùƒ ÙØ§Ø±Øº Ù„Ù„ØªØ®Ø·ÙŠ:`);
        if (g === null) break;
        g = g.trim();
        if (!g) continue;
        const gi = parseInt(g) - 1;
        if (isNaN(gi) || gi < 0 || gi>= STATE.groups.length) { alert('Ø±Ù‚Ù… Ù…Ø¬Ù…ÙˆØ¹Ø© ØºÙŠØ± ØµØ­ÙŠØ­'); continue; }
            STATE.groups[gi].push(name);
            STATE.teams.find(t => t.name === name).group = gi;
            }
            scheduleAllGroupMatches();
            saveState();
            renderGroupsOverview();
            document.getElementById('teamsInputCard').style.display = 'none';
            document.getElementById('groupsOverview').style.display = 'block';
            scrollToElement('groupsOverview');
            }

            /* render groups overview */
            function renderGroupsOverview() {
            const list = document.getElementById('groupsList');
            if (!list) return;
            list.innerHTML = '';
            STATE.groups.forEach((g, i) => {
            const div = document.createElement('div'); div.className = 'group-card';
            div.innerHTML = `<strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© ${String.fromCharCode(65 + i)}</strong>
            <div class="small muted">${g.length} ÙØ±ÙŠÙ‚</div>`;
            div.onclick = () => showGroupDetails(i);
            list.appendChild(div);
            });
            }

            /* schedule round-robin matches for each group */
            function scheduleAllGroupMatches() {
            STATE.groupMatches = STATE.groupMatches || [];
            STATE.groupMatches = [];
            let id = 1;
            STATE.groups.forEach((grp, gi) => {
            for (let i = 0; i < grp.length; i++) { for (let j=i + 1; j < grp.length; j++) { STATE.groupMatches.push({
                id: id++, group: gi, home: grp[i], away: grp[j], hg: 0, ag: 0, finished: false }); } } }); } /* show
                details of a group */ function showGroupDetails(gi) { const teams=STATE.groups[gi] || [];
                document.getElementById('groupTitle').textContent=`Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© ${String.fromCharCode(65 + gi)}`;
                document.getElementById('groupTeamsLine').textContent=teams.join(' â€” ') || ' Ù„Ø§ ØªÙˆØ¬Ø¯ ÙØ±Ù‚'; const
                matchesDiv=document.getElementById('groupMatches'); matchesDiv.innerHTML='' ; const
                matches=STATE.groupMatches.filter(m=> m.group === gi);
                if (matches.length === 0) matchesDiv.innerHTML = '<div class="small muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ù…Ø¬Ø¯ÙˆÙ„Ø©.</div>
                ';
                matches.forEach(m => {
                const d = document.createElement('div'); d.className = 'match';
                d.innerHTML = `<div class="teams">${m.home} <span style="opacity:0.6">vs</span> ${m.away}</div>
                <div>
                    ${m.finished ? `<span class="small muted">${m.hg} - ${m.ag}</span>` : `<button
                        class="primary inline" data-id="${m.id}">Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù…Ø§ØªØ´</button>`}
                    <button class="ghost inline" data-edit="${m.id}">ØªØ¹Ø¯ÙŠÙ„</button>
                </div>`;
                matchesDiv.appendChild(d);
                });
                matchesDiv.querySelectorAll('button.primary').forEach(b => {
                b.onclick = () => { const id = parseInt(b.dataset.id); endGroupMatch(id); };
                });
                matchesDiv.querySelectorAll('button.ghost').forEach(b => {
                b.onclick = () => { const id = parseInt(b.dataset.edit); editMatchTeams(id); };
                });
                renderGroupTable(gi);
                document.getElementById('groupDetails').style.display = 'block';
                scrollToElement('groupDetails');
                }

                /* end group match with prompt for goals */
                function endGroupMatch(matchId) {
                const m = STATE.groupMatches.find(x => x.id === matchId);
                if (!m) return alert('Ù…Ø¨Ø§Ø±Ø§Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©');
                const hg = prompt(`Ø£Ù‡Ø¯Ø§Ù ${m.home}:`, m.hg || 0);
                if (hg === null) return;
                const ag = prompt(`Ø£Ù‡Ø¯Ø§Ù ${m.away}:`, m.ag || 0);
                if (ag === null) return;
                m.hg = parseInt(hg) || 0; m.ag = parseInt(ag) || 0; m.finished = true;
                recomputeTeamsFromMatches();
                saveState();
                showGroupDetails(m.group);
                renderDashboard();
                }

                /* edit teams in a match */
                function editMatchTeams(matchId) {
                const m = STATE.groupMatches.find(x => x.id === matchId);
                if (!m) return alert('Ù…Ø¨Ø§Ø±Ø§Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©');
                const h = prompt('Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„:', m.home || '');
                const a = prompt('Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ:', m.away || '');
                if (h === null || a === null) return;
                m.home = h.trim() || m.home; m.away = a.trim() || m.away;
                saveState();
                showGroupDetails(m.group);
                }

                /* recompute all teams stats from finished matches */
                function recomputeTeamsFromMatches() {
                const names = new Set();
                STATE.groups.forEach(g => g.forEach(n => names.add(n)));
                (STATE.groupMatches || []).forEach(m => { names.add(m.home); names.add(m.away); });
                STATE.teams = Array.from(names).map(n => {
                const existing = (STATE.teams || []).find(t => t.name === n);
                if (existing) return { ...{ name: n, played: 0, win: 0, draw: 0, loss: 0, gf: 0, ga: 0, pts: 0, group:
                existing.group ?? findGroupOfTeam(n) }, ...existing, played: 0, win: 0, draw: 0, loss: 0, gf: 0, ga: 0,
                pts: 0
                };
                return { name: n, played: 0, win: 0, draw: 0, loss: 0, gf: 0, ga: 0, pts: 0, group: findGroupOfTeam(n)
                };
                });
                STATE.teams.forEach(t => { t.played = 0; t.win = 0; t.draw = 0; t.loss = 0; t.gf = 0; t.ga = 0; t.pts =
                0; });
                (STATE.groupMatches || []).filter(m => m.finished).forEach(m => {
                const H = STATE.teams.find(t => t.name === m.home);
                const A = STATE.teams.find(t => t.name === m.away);
                if (!H || !A) return;
                H.played++; A.played++;
                H.gf += m.hg; H.ga += m.ag;
                A.gf += m.ag; A.ga += m.hg;
                if (m.hg > m.ag) { H.win++; H.pts += 3; A.loss++; }
                else if (m.hg < m.ag) { A.win++; A.pts +=3; H.loss++; } else { H.draw++; A.draw++; H.pts++; A.pts++; }
                    }); if (STATE.knockout && STATE.knockout.rounds) { STATE.knockout.rounds.flat().filter(s=> s &&
                    s.finished && s.home
                    && s.away).forEach(s => {
                    const H = STATE.teams.find(t => t.name === s.home) || { name: s.home, played: 0, win: 0, draw: 0,
                    loss: 0, gf:
                    0, ga: 0, pts: 0 };
                    const A = STATE.teams.find(t => t.name === s.away) || { name: s.away, played: 0, win: 0, draw: 0,
                    loss: 0, gf:
                    0, ga: 0, pts: 0 };
                    if (!STATE.teams.find(t => t.name === s.home)) STATE.teams.push(H);
                    if (!STATE.teams.find(t => t.name === s.away)) STATE.teams.push(A);
                    H.played++; A.played++;
                    H.gf += s.hg; H.ga += s.ag;
                    A.gf += s.ag; A.ga += s.hg;
                    if (s.hg > s.ag) { H.win++; H.pts += 3; A.loss++; }
                    else if (s.hg < s.ag) { A.win++; A.pts +=3; H.loss++; } else { H.draw++; A.draw++; H.pts++; A.pts++;
                        } }); } } /* find group index of a team */ function findGroupOfTeam(name) { for (let i=0; i <
                        STATE.groups.length; i++) { if (STATE.groups[i].includes(name)) return i; } return null; } /*
                        render group table */ function renderGroupTable(gi) { recomputeTeamsFromMatches(); const
                        tbody=document.querySelector('#groupTable tbody'); if (!tbody) return; tbody.innerHTML='' ;
                        const groupNames=STATE.groups[gi] || []; const rows=STATE.teams.filter(t=> t.group === gi).map(t
                        => ({ ...t, gd: t.gf - t.ga }));
                        if (rows.length === 0 && groupNames.length > 0) {
                        groupNames.forEach((n, idx) => tbody.innerHTML += `<tr>
                            <td>${idx + 1}</td>
                            <td>${n}</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                        </tr>`);
                        return;
                        }
                        rows.sort((a, b) => b.pts - a.pts || (b.gd - a.gd) || b.gf - a.gf ||
                        a.name.localeCompare(b.name));
                        rows.forEach((r, i) => {
                        const tr = document.createElement('tr');
                        tr.innerHTML = `<td>${i + 1}</td>
                        <td>${r.name}</td>
                        <td>${r.played}</td>
                        <td>${r.win}</td>
                        <td>${r.draw}</td>
                        <td>${r.loss}</td>
                        <td>${r.gf}</td>
                        <td>${r.ga}</td>
                        <td>${r.gf - r.ga}</td>
                        <td>${r.pts}</td>`;
                        tbody.appendChild(tr);
                        });
                        }

                        /* ---------- Bracket building & rendering ---------- */
                        const btnBuildBracket = document.getElementById('btnBuildBracket');
                        if (btnBuildBracket) btnBuildBracket.onclick = () => {
                        const qual = parseInt(document.getElementById('qualifyCount').value) || 1;
                        recomputeTeamsFromMatches();
                        const qualifiers = [];
                        STATE.groups.forEach((grp, gi) => {
                        const stats = (STATE.teams.filter(t => t.group === gi) || []).slice();
                        stats.sort((a, b) => b.pts - a.pts || (b.gf - b.ga) - (a.gf - a.ga) || b.gf - a.gf);
                        for (let i = 0; i < qual && i < stats.length; i++) qualifiers.push(stats[i].name); }); if
                            (qualifiers.length < 2) return alert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ø¯Ø¯ ÙƒØ§ÙÙ Ù…Ù† Ø§Ù„Ù…ØªØ£Ù‡Ù„ÙŠÙ†.');
                            buildKnockout(qualifiers); renderBracketArea();
                            document.querySelector('[data-tab="tab-bracket" ]').click(); saveState(); }; function
                            buildKnockout(qualifiers) { let n=qualifiers.length; let pow=1; while (pow < n) pow *=2;
                            const slots=pow / 2; const rounds=[]; const first=[]; for (let i=0; i < slots; i++) { const
                            a=qualifiers[i] || null; const b=qualifiers[qualifiers.length - 1 - i] || null; first.push({
                            home: a, away: b, hg: 0, ag: 0, finished: false, id: `r0s${i}` }); } rounds.push(first); let
                            rem=slots / 2; let r=1; while (rem>= 1) {
                            rounds.push(Array.from({ length: rem }, (_, i) => ({ home: null, away: null, hg: 0, ag: 0,
                            finished:
                            false, id: `r${r}s${i}` })));
                            rem = Math.floor(rem / 2); r++;
                            }
                            STATE.knockout = { rounds };
                            }

                            /* render bracket area */
                            function renderBracketArea() {
                            const area = document.getElementById('bracketArea'); if (!area) return; area.innerHTML = '';
                            if (!STATE.knockout || !STATE.knockout.rounds) { area.innerHTML = '<div class="small muted">
                                Ù„Ø§ ØªÙˆØ¬Ø¯ Ø´Ø¬Ø±Ø©
                                Ø­Ø§Ù„ÙŠØ§Ù‹ â€” Ø£Ù†Ø´Ø£ Ø§Ù„Ù…ØªØ£Ù‡Ù„ÙŠÙ† Ø«Ù… Ø§Ø¶ØºØ· Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø´Ø¬Ø±Ø©.</div>'; return; }
                            const rounds = STATE.knockout.rounds;
                            rounds.forEach((rnd, ri) => {
                            const col = document.createElement('div'); col.className = 'bracket-col';
                            const title = document.createElement('div'); title.style.fontWeight = '700';
                            title.textContent = ri ===
                            rounds.length - 1 ? 'Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ' : `Ø¯ÙˆØ± ${ri + 1}`;
                            col.appendChild(title);
                            rnd.forEach(slot => {
                            const box = document.createElement('div'); box.className = 'slot';
                            const h = slot.home || 'â€”'; const a = slot.away || 'â€”';
                            box.innerHTML = `<div class="team">${h}</div>
                            <div style="opacity:0.6;margin:6px 0">vs</div>
                            <div class="team">${a}</div>
                            <div class="controls">
                                <button class="primary" data-id="${slot.id}">Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù…Ø§ØªØ´</button>
                                <button class="ghost" data-edit="${slot.id}">ØªØ¹Ø¯ÙŠÙ„</button>
                            </div>`;
                            col.appendChild(box);
                            });
                            area.appendChild(col);
                            });
                            document.querySelectorAll('.slot .primary').forEach(b => {
                            b.onclick = () => {
                            const id = b.dataset.id;
                            const slot = findKnockoutSlotById(id);
                            if (!slot) return alert('Ø®Ø·Ø£');
                            if (!slot.home || !slot.away) return alert('Ø­Ø¯Ø¯ ÙƒÙ„Ø§ Ø§Ù„ÙØ±ÙŠÙ‚ÙŠÙ† Ø£ÙˆÙ„Ø§Ù‹');
                            const hg = prompt(`Ø£Ù‡Ø¯Ø§Ù ${slot.home}:`, slot.hg || 0);
                            if (hg === null) return;
                            const ag = prompt(`Ø£Ù‡Ø¯Ø§Ù ${slot.away}:`, slot.ag || 0);
                            if (ag === null) return;
                            slot.hg = parseInt(hg) || 0; slot.ag = parseInt(ag) || 0; slot.finished = true;
                            recomputeTeamsFromMatches();
                            const winner = slot.hg > slot.ag ? slot.home : (slot.hg < slot.ag ? slot.away : null); if
                                (winner) advanceKnockout(slot.id, winner); saveState(); renderBracketArea();
                                renderDashboard(); }; }); document.querySelectorAll('.slot .ghost').forEach(b=> {
                                b.onclick = () => {
                                const id = b.dataset.edit; const slot = findKnockoutSlotById(id);
                                if (!slot) return;
                                const h = prompt('Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„:', slot.home || '');
                                const a = prompt('Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ:', slot.away || '');
                                if (h === null || a === null) return;
                                slot.home = h.trim() || slot.home; slot.away = a.trim() || slot.away;
                                saveState(); renderBracketArea();
                                };
                                });
                                }
                                function findKnockoutSlotById(id) {
                                if (!STATE.knockout) return null;
                                for (const rnd of STATE.knockout.rounds) for (const s of rnd) if (s.id === id) return s;
                                return null;
                                }
                                function advanceKnockout(slotId, winner) {
                                for (let r = 0; r < STATE.knockout.rounds.length; r++) { const
                                    idx=STATE.knockout.rounds[r].findIndex(s=> s.id === slotId);
                                    if (idx !== -1) {
                                    const next = r + 1;
                                    if (next < STATE.knockout.rounds.length) { const
                                        target=STATE.knockout.rounds[next][Math.floor(idx / 2)]; if (!target.home)
                                        target.home=winner; else if (!target.away) target.away=winner; else
                                        target.home=winner; saveState(); } else { alert('Ø§Ù„ÙØ§Ø¦Ø² Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ' + winner);
          }
          break;
        }
      }
    }

    /* ---------- Dashboard rendering ---------- */
    function renderDashboard() {
      recomputeTeamsFromMatches();
      const winnersBody = document.querySelector(' #winnersTable tbody'); if (winnersBody) winnersBody.innerHTML='' ;
                                        const losersBody=document.querySelector('#losersTable tbody'); if (losersBody)
                                        losersBody.innerHTML='' ; const arr=STATE.teams.slice(); const
                                        winners=arr.filter(t=> t.win >
                                        t.loss).sort((a, b) => b.pts - a.pts);
                                        const losers = arr.filter(t => t.loss > t.win).sort((a, b) => b.loss - a.loss);
                                        winners.forEach(w => { if (winnersBody) winnersBody.innerHTML += `<tr
                                            class="winner">
                                            <td>${w.name}</td>
                                            <td>${w.win}</td>
                                            <td>${w.pts}</td>
                                        </tr>`; });
                                        losers.forEach(l => { if (losersBody) losersBody.innerHTML += `<tr
                                            class="loser">
                                            <td>${l.name}</td>
                                            <td>${l.loss}</td>
                                            <td>${l.pts}</td>
                                        </tr>`; });
                                        const groupsTables = document.getElementById('groupsTables'); if (!groupsTables)
                                        return;
                                        groupsTables.innerHTML = '';
                                        STATE.groups.forEach((grp, gi) => {
                                        const box = document.createElement('div'); box.style.minWidth = '320px';
                                        box.style.flex = '1';
                                        let rows = STATE.teams.filter(t => t.group === gi).map(t => ({ ...t, gd: t.gf -
                                        t.ga }));
                                        if (rows.length === 0) {
                                        rows = grp.map(n => ({ name: n, played: 0, win: 0, draw: 0, loss: 0, gf: 0, ga:
                                        0, pts: 0, gd: 0
                                        }));
                                        } else {
                                        rows.sort((a, b) => b.pts - a.pts || (b.gd - a.gd) || b.gf - a.gf);
                                        }
                                        box.innerHTML = `<div class="card">
                                            <h4 class="center">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© ${String.fromCharCode(65 + gi)}</h4>
                                            <table>
                                                <thead>
                                                    <tr>
                                                        <th>Ø§Ù„ÙØ±ÙŠÙ‚</th>
                                                        <th>Ù†Ù‚Ø§Ø·</th>
                                                        <th>Ù„Ù‡</th>
                                                        <th>Ø¹Ù„ÙŠÙ‡</th>
                                                        <th>ÙØ±Ù‚</th>
                                                    </tr>
                                                </thead>
                                                <tbody>${rows.map(r => `<tr>
                                                        <td>${r.name}</td>
                                                        <td>${r.pts}</td>
                                                        <td>${r.gf}</td>
                                                        <td>${r.ga}</td>
                                                        <td>${r.gf - r.ga}</td>
                                                    </tr>`).join('')}</tbody>
                                            </table>
                                        </div>`;
                                        groupsTables.appendChild(box);
                                        });
                                        }

                                        /* ---------- helpers & lifecycle ---------- */
                                        function scrollToElement(id) { const el = document.getElementById(id); if (el)
                                        el.scrollIntoView({
                                        behavior: 'smooth', block: 'start' }); }

                                        /* initial load */
                                        (function init() {
                                        const loaded = loadState();
                                        if (!loaded) {
                                        STATE = { teams: [], groups: [], groupMatches: [], knockout: null };
                                        } else {
                                        renderGroupsOverview();
                                        }
                                        })();

                                        /* save/load buttons */
                                        const saveBtnEl = document.getElementById('saveBtn');
                                        if (saveBtnEl) saveBtnEl.addEventListener('click', saveState);
                                        const loadBtnEl = document.getElementById('loadBtn');
                                        if (loadBtnEl) loadBtnEl.addEventListener('click', () => { if (!loadState())
                                        alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª
                                        Ù…Ø­ÙÙˆØ¸Ø©.'); });

                                        /* render after load (populate UI) */
                                        function renderAfterLoad() {
                                        if (!STATE) return;
                                        if (STATE.groups && STATE.groups.length > 0) {
                                        document.getElementById('groupsOverview').style.display = 'block';
                                        renderGroupsOverview();
                                        }
                                        if (!STATE.groupMatches || STATE.groupMatches.length === 0) {
                                        scheduleAllGroupMatches();
                                        saveState();
                                        }
                                        renderDashboard();
                                        }

                                        /* ensure recompute / render when tab changed manually to dashboard */
                                        const tbDash = document.querySelector('[data-tab="tab-dashboard"]');
                                        if (tbDash) tbDash.addEventListener('click', () => renderDashboard());

                                        /* ===== End of embedded original app code ===== */

                                        </script>
                                        <script type="module">
    // Import the functions you need from the SDKs you need
        import {initializeApp} from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBN6E-bH6xiVntoLJlET2wx3SydGwqIr_w",
        authDomain: "my-login-app-4722d.firebaseapp.com",
        databaseURL: "https://my-login-app-4722d-default-rtdb.firebaseio.com",
        projectId: "my-login-app-4722d",
        storageBucket: "my-login-app-4722d.firebasestorage.app",
        messagingSenderId: "1074822411897",
        appId: "1:1074822411897:web:81cd47e0ae3e5c6d6cc6a8"
    };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);

        if (app) {
            console.log("fierbase init  done");
    }
        else {
            console.log("fierbase init  eror");
    }
                                        </script>
</body>

</html>